# 美食交流社区项目开发文档

## 1. 项目描述

本项目是一个基于React的美食交流社区平台，旨在为用户提供分享和获取美食菜谱、食材知识和烹饪技巧的平台。文章详情以美食为核心，介绍了美食的内容和做法，并且提供了互动功能，用户可以进行回复交流。

## 2. 主要页面

1. 首页页面
2. 文章详情页面

## 3. 技术栈

- React 18: 利用React框架构建用户界面
- TypeScript: 添加静态类型检查，提高代码质量
- React Router 6: 添加前端路由，实现页面跳转 
- Ant Design: 使用UI组件库提高开发效率
- Sass/SCSS: 增强CSS能力，更好组织样式代码
- Axios: 处理HTTP请求，与后端API交互
- Lodash: 提供实用工具函数，如防抖函数实现
- Json-server：开发阶段模拟后端API接口

## 4. 路由设计

- 首页：'/'
- 文章详情页：'/article:?id'
- 社区页面：'/community'
- 菜谱页面：'/recipe'
- 食材页面：'/ingredient'
- 404页面：'*'

## 5. 页面设计

### 5.1 首页

1. 导航栏：点击导航栏跳转页面
2. 模糊搜索框：模拟搜索功能
3. 轮播图：左侧为轮播图，右侧为热门菜品
4. 推荐菜谱：展示推荐的菜品和名字
5. 今日菜谱：展示菜谱文章内容和浏览点赞
6. 文章排行榜：展示热门文章的发布情况
7. 菜谱标签：提供精彩菜谱分类标签
8. 底部版权：提供版权权限和联系

### 5.2 文章详情页

1. 返回上一级：点击之后返回上级路由
2. 用户区域：展示用户信息和发表信息
3. 菜品内容介绍：展示文章内容
4. 评论区：发布评论和回复评论
5. 底部版权：提供版权权限和联系

## 6. 模块分析（首页）

### 6.1 导航栏和模糊搜索框



导航栏使用antd组件库中的menu组件进行设置导航栏，然后通过父级包裹div使用flex布局进行排列，右侧搜索框通过使用useState和useRef进行绑定数据和修改数据。模糊搜索主要方式是通过过滤数组进行渲染页面来实现，当输入框内容改变时，过滤的数组也发生改变，从而实现模糊搜索的效果。

### 6.2 轮播图区域模块

封装一个CarouselComponent组件，使用antd中的Carousel组件进行渲染，然后导入到首页轮播图区域，在封装的组件中请求数据渲染到轮播图上，再在轮播图组件右方写入热门菜品，然后通过flex布局竖着排列到轮播图右侧，并且使用遮罩和hover实现动画效果。

### 6.3 推荐菜品模块

定义一个菜品区域，通过封装一个RecommendedDishes组件展示每一个菜品的图片和名字，父级通过请求渲染列表然后通过ul嵌套li的方式进行渲染RecommendedDishes组件，通过传入id，url，name进行渲染。

### 6.4 今日菜谱模块

定义一个ArticleAndShaking组件进行布局文章列表和排行榜，ArticleAndShaking分为两个区域，left区域和right区域。left区域为文章列表区域，每个文章列表通过封装ArticleComponent组件，传入id、url、text、title、tag、like、views等数据然后进行渲染页面，并在图片和标题上添加点击事件使用useNavigate进行页面跳转，跳转的时候携带文章id。right区域封装了一个RankingComponent组件，通过使用antd中的两个Tabs组件，然后嵌套，并使用useState存储点击的选项id，最后通过将id获取接口数据，通过ul、li进行渲染用户列表，返回的数据通过lodash中的orderBy方法进行排序，最后渲染到页面上。

### 6.5 菜谱标签模块

封装了一个ClassicTagComponent组件，通过li遍历直接渲染ClassicTagComponent组件，然后通过flex布局进行三行排列。

### 6.6 版权模块

调用FooterComponent模块来存放版权，通过ul嵌套li的效果进行排列。

## 7. 模块分析（文章详情页）

### 7.1 返回上一级模块

通过使用antd中的LeftOutlined组件导入左箭头，然后添加文字，之后用div进行包裹，放在文章页面的左上角，并且使用useNavigate进行跳转上一级。

### 7.2 用户区域

首先通过useParams获取传入的id值，然后通过useEffect调用api里边的方法在组件渲染之前获取文章数据，然后设置状态数据数组。通过div实现包括用户区域，使用img、span、button等来实现布局。

### 7.3 文章内容区域

使用article标签来包裹文章内容区域，使用h2标签作为标签分类，下方通过div、span、ul、li等标签进行布局，再通过设置样式达到页面效果。

### 7.4 评论区

首先通过footer标签进行设置评论区域，comment类为设置用户发布评论的区域，在里边添加img、input、button按钮，然后通过获取的数据进行渲染头像，使用flex布局进行一行排列。

commentView区域为下方评论标题，标签通过div和h4进行设置。

最后通过获取的数据进行渲染用户对该文章的评论，并且渲染过程中封装了一个CommentComponent组件进行渲染。

CommentComponent组件的主要功能是点赞和回复功能，渲染页面主要是通过div、span、p、button标签等。点赞功能主要是通过设置一个类，然后当点击这个按钮时使用classList.toggle进行添加，如果点过了就取消，没有就添加。回复功能是通过设置一个useState状态变量进行判断是否出现回复输入框，如果没有点击则正常显示回复内容，如果点击了就隐藏回复内容然后进行回复。然后通过useRef获取回复内容，然后点击回复之后则将自身数据和输入框数据进行拼接加入到文章列表之中，然后触发useState渲染机制进行渲染到页面上实现回复功能。

### 7.5 版权模块

调用FooterComponent模块来存放版权，通过ul嵌套li的效果进行排列。

## 8. 遇见的问题和如何解决

### 问题1
在跳转页面之后刷新页面，导航栏没有实现高亮效果

**解决方案**：设置defaultSelectedKeys={[window.location.pathname]}通过location.pathname获取当前路径，然后设置默认选中实现高亮

### 问题2
在搜索框中点击搜索按钮之后没有触发lodash中debounce防抖效果

**解决方案**：定义一个新的方法，通过调用useMemo进行赋值确定每次只创建一次调用debounce的方法实现防抖效果

### 问题3
在模糊搜索的时候给li添加点击事件之后没法将数据渲染到输入框里边

**解决方案**：给输入框设置onBlur失焦的时候延迟2秒，这样就不会在点击一下li就直接失去焦点，从而获取不到数据给输入框

## 9. 总结

本项目成功构建了一个美食交流社区平台，综合运用了React、TypeScript、Ant Design等前端技术栈。通过合理的组件封装和状态管理，实现了包括模糊搜索、文章展示、评论互动等核心功能，为用户提供了良好的社区交流体验。

在开发过程中更加熟练的使用组件进行开发，将复杂的UI拆分为可复用的组件。学会了使用Json-Server进行模拟接口，使用axios进行编写api进行获取数据。学会了实现模糊搜索和实现防抖功能。 